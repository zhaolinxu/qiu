<!DOCTYPE html>
<html ng-app=game ng-controller=GameController>
  
  <head>
    <meta charset=utf-8>
    <meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel=stylesheet type=text/css href="css/bootstrap.min.css">
    <link ng-if=isThemeCustom() rel=stylesheet type=text/css ng-href=css/{{getThemeFile()}}>
    <link rel=stylesheet type=text/css href="css/game.min-v=27.css">
    <script type=text/javascript src="js/angular.min.js"></script>
    <script type=text/javascript src="js/angular-animate.min.js"></script>
    <script type=text/javascript src="js/angular-sanitize.min.js"></script>
    <script type=text/javascript src="js/decimal.min.js"></script>
    <script type=text/javascript src="js/game.min-v=70.js"></script>
    <meta name=application-name content="Idle Bouncer"></head>
  
  <body ng-mousedown=gameMouseDown($event) ng-mouseup=gameMouseUp($event) ng-keypress=gameKeyPress($event) ng-keydown=gameKeyDown($event) ng-keyup=gameKeyUp($event)>
    <script ng-if=!isSteamVersion>!
      function(e, t, a, c, n, o, s) {
        e.GoogleAnalyticsObject = n,
        e[n] = e[n] ||
        function() { (e[n].q = e[n].q || []).push(arguments)
        },
        e[n].l = 1 * new Date,
        o = t.createElement(a),
        s = t.getElementsByTagName(a)[0],
        o.async = 1,
        o.src = c,
        s.parentNode.insertBefore(o, s)
      } (window, document, "script", "https://www.google-analytics.com/analytics.js", "ga"),
      ga("create", "UA-12215585-11", "auto"),
      ga("require", "ecommerce")</script>
    <div id=gamearea>
      <div id=initializing ng-if=!init class=container>Initializing...</div>
      <script>setTimeout(function() {
          var e = document.getElementById("initializing");
          e && (e.innerHTML = 'Something went wrong.<br/>May be you have a slow internet connection.<br/>Or you are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/" target="_blank">upgrade your browser</a> to improve your experience.')
        },
        1e4)</script>
      <div class="container-fluid ng-hide" ng-show=init ng-cloak>
        <div class=row>
          <div id=gamearea-left>
            <div class="panel panel-default" ng-class=getBgClass()>
              <div class="panel-body field-panel panel-no-top-padding">
                <div class=img-wrap>
                  <canvas id=canvas-bottom class=img-wrapped></canvas>
                  <div class=spikes ng-class="{'spikes-off':hideSpikes()}"></div>
                  <table class="table table-condensed table-no-lines table-no-bottom-margin">
                    <tr>
                      <td width=1%>
                        <span class="glyphicon glyphicon-flash"></span>
                      </td>
                      <td>
                        <uibm-progressbar value=energyDC() max=energyMaxDC()>{{energyDC() | bignum:2}} / {{energyMaxDC() | bignum:2}} ({{energyPercent()}}%)
                          <small>+{{getEnergyPerSecondDC() | bignum:1:1}}/sec</small></uibm-progressbar>
                      </td>
                    </tr>
                  </table>
                  <div class=small ng-controller="IdleEnergyController as ieCtr">
                    <div class=row ng-if=ieCtr.isIdleEnergyAvailable()>
                      <div class=col-xs-4>
                        <span class=animate-fade ng-show=ieCtr.showIdleTimer() ng-bind-html=ieCtr.getIdleTimerHtml()></span>
                      </div>
                      <div class=col-xs-8>
                        <span class=animate-fade ng-show=ieCtr.showIdleEnergy() ng-bind-html=ieCtr.getIdleEnergyHtml()></span>
                      </div>
                    </div>
                  </div>
                  <canvas id=canvas ng-mousedown=doClickCanvas($event) class=img-wrapped></canvas>
                </div>
                <div>
                  <div class=row>
                    <div class="col-xs-4 small">Tube info:&nbsp;
                      <div class="btn-group btn-group-xs" role=group>
                        <button type=button class="btn btn-default" ng-class="{active:getTubeInfoType()=='percent'}" ng-click="setTubeInfoType('percent')">%</button>
                        <button type=button class="btn btn-default" ng-class="{active:getTubeInfoType()=='epersec'}" ng-click="setTubeInfoType('epersec')">
                          <span class="glyphicon glyphicon-flash"></span>/sec</button>
                      </div>
                    </div>
                    <div class="col-xs-4 small text-center">
                      <button ng-if=isNewVersion() type=button class="btn btn-danger btn-xs new-version-alert-button" ng-click=reloadGame()>New version available</button>
                      <button ng-if=isBoostDailyGenerated() type=button class="btn btn-warning btn-xs" ng-click=showBoostDailyDlg()>New daily reward available</button></div>
                    <div class="col-xs-4 text-right small">Scale: &times;{{visualScale() | number:3}}</div></div>
                </div>
              </div>
            </div>
          </div>
          <div id=gamearea-right>
            <section ng-controller="TabsController as tab">
              <ul class="nav nav-tabs">
                <li role=presentation ng-class="{active:tab.isSelected('Main')}">
                  <a href="index.html#" ng-click="tab.select('Main')" m-prevent-default title=Upgrades>
                    <img ng-src=imgs/{{getThemeImgDir()}}/upgrades.svg class=tab-img>
                    <span class=tab-name>Upgrades</span></a>
                </li>
                <li role=presentation ng-class="{active:tab.isSelected('Reset')}">
                  <a href="index.html#" ng-click="tab.select('Reset')" m-prevent-default title=Meta-energy>
                    <img ng-src=imgs/{{getThemeImgDir()}}/reset.svg class=tab-img>
                    <span class=tab-name>Meta-energy</span></a>
                </li>
                <li role=presentation ng-class="{active:tab.isSelected('Achievements')}">
                  <a href="index.html#" ng-click="tab.select('Achievements')" m-prevent-default title=Achievements>
                    <img ng-src=imgs/{{getThemeImgDir()}}/achievements.svg class=tab-img>
                    <span class=tab-name>Achievements</span>
                    <span class="glyphicon glyphicon-info-sign" ng-show=isNewAchievementAvailable()></span>
                  </a>
                </li>
                <li role=presentation ng-class="{active:tab.isSelected('Stats')}">
                  <a href="index.html#" ng-click="tab.select('Stats')" m-prevent-default title=Statistics>
                    <img ng-src=imgs/{{getThemeImgDir()}}/statistics.svg class=tab-img>
                    <span class=tab-name>Statistics</span></a>
                </li>
                <li role=presentation ng-class="{active:tab.isSelected('Events')}">
                  <a href="index.html#" ng-click="tab.select('Events')" m-prevent-default title=Events>
                    <img ng-src=imgs/{{getThemeImgDir()}}/halloweenicon.gif class=tab-img>
                    <span class=tab-name>&nbsp;Events</span></a>
                </li>
                <li role=presentation ng-class="{active:tab.isSelected('Settings')}">
                  <a href="index.html#" ng-click="tab.select('Settings')" m-prevent-default title=Settings>
                    <img ng-src=imgs/{{getThemeImgDir()}}/settings.svg class=tab-img>
                    <span class=tab-name>Settings</span></a>
                </li>
                <li role=presentation ng-class="{active:tab.isSelected('Premium')}">
                  <a href="index.html#" ng-click="tab.select('Premium')" m-prevent-default title=Shop>
                    <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=tab-img>
                    <span class=tab-name>Shop</span></a>
                </li>
              </ul>
              <div class="tab-content scroll-section" ng-if="tab.isSelected('Main')" ng-controller="UpgradeController as upgCtr">
                <div class=content-block ng-controller="BuyAmountController as buyAmount">
                  <small>
                    <span ng-if=!buyAmount.isBuyAmountStepPosRight()>
                      <b>Step</b>:
                      <div class="btn-group btn-group-xs" role=group>
                        <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountStepList" ng-class="{active:buyAmount.getBuyAmountObject().step==item}" ng-click=buyAmount.setBuyAmountValueStep(item) title={{buyAmount.getBuyAmountStepHotKey(itemId)}}>{{item}}</button></div>&nbsp;</span>
                    <b>Buy amount</b>:
                    <div class="btn-group btn-group-xs" role=group>
                      <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountRelList" ng-class="{active:buyAmount.getBuyAmountObject().rel==item.value}" ng-click=buyAmount.setBuyAmountValueRel(item.value) title={{buyAmount.getBuyAmountRelHotKey(itemId)}}>{{item.text}}</button></div>
                    <span ng-if=buyAmount.isBuyAmountStepPosRight()>&nbsp;
                      <b>Step</b>:
                      <div class="btn-group btn-group-xs" role=group>
                        <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountStepList" ng-class="{active:buyAmount.getBuyAmountObject().step==item}" ng-click=buyAmount.setBuyAmountValueStep(item) title={{buyAmount.getBuyAmountStepHotKey(itemId)}}>{{item}}</button></div>
                    </span>&nbsp;
                    <a href="index.html#" ng-mouseenter=buyAmount.setHintVisible(true) ng-mouseleave=buyAmount.setHintVisible(false) m-prevent-default>
                      <span class="glyphicon glyphicon-question-sign"></span></a>
                  </small>
                  <div class="popover bottom animate-fade" role=tooltip style=top:80px;left:700px;display:block ng-show=buyAmount.isHintVisible()>
                    <div class=arrow style=bottom:50%;left:87%></div>
                    <h3 class=popover-title>Buy amount hotkeys</h3>
                    <div class=popover-content>
                      <p>You can use hotkeys 1-0 and "-" to change buy amount and step.</p>
                      <p>You can swap "Buy amount" and "Step" positions in the Settings tab.</p>
                    </div>
                  </div>
                </div>
                <section ng-controller="TabsUpgradeController as tabUpg">
                  <ul class="nav nav-tabs">
                    <li role=presentation ng-class="{active:tabUpg.isSelected('Main')}">
                      <a href="index.html#" ng-click="tabUpg.select('Main')" m-prevent-default title=Energy>
                        <sup>[q,a]</sup>
                        <img ng-src=imgs/{{getThemeImgDir()}}/upgrade_energy.svg class=tab-img-small>
                        <span class=tab-name>&nbsp;Energy</span>
                        <span ng-if=upgCtr.showUpgradeCntInTab() class=badge>{{upgCtr.getEnergyUpsAvail()}}</span></a>
                    </li>
                    <li role=presentation ng-class="{active:tabUpg.isSelected('BallBounce')}">
                      <a href="index.html#" ng-click="tabUpg.select('BallBounce')" m-prevent-default title=Bounce>
                        <sup>[w,z]</sup>
                        <img ng-src=imgs/{{getThemeImgDir()}}/upgrade_bounce.svg class=tab-img-small>
                        <span class=tab-name>&nbsp;Bounce</span>
                        <span ng-if=upgCtr.showUpgradeCntInTab() class=badge>{{upgCtr.getBounceUpsAvail()}}</span></a>
                    </li>
                    <li role=presentation ng-class="{active:tabUpg.isSelected('BallSize')}">
                      <a href="index.html#" ng-click="tabUpg.select('BallSize')" m-prevent-default title="Ball size">
                        <sup>[e]</sup>
                        <img ng-src=imgs/{{getThemeImgDir()}}/upgrade_ball_size.svg class=tab-img-small>
                        <span class=tab-name>&nbsp;Ball size</span>
                        <span ng-if=upgCtr.showUpgradeCntInTab() class=badge>{{upgCtr.getBallSizeUpsAvail()}}</span></a>
                    </li>
                    <li role=presentation ng-class="{active:tabUpg.isSelected('TubeHeight')}">
                      <a href="index.html#" ng-click="tabUpg.select('TubeHeight')" m-prevent-default title="Tube height">
                        <sup>[r]</sup>
                        <img ng-src=imgs/{{getThemeImgDir()}}/upgrade_tube_height.svg class=tab-img-small>
                        <span class=tab-name>&nbsp;Tube height</span>
                        <span ng-if=upgCtr.showUpgradeCntInTab() class=badge>{{upgCtr.getTubeHeightUpsAvail()}}</span></a>
                    </li>
                    <li ng-if=upgCtr.isAbilitiesTabVisible() role=presentation ng-class="{active:tabUpg.isSelected('Abilities')}">
                      <a href="index.html#" ng-click="tabUpg.select('Abilities')" m-prevent-default title=Abilities>
                        <sup>[t]</sup>
                        <img ng-src=imgs/{{getThemeImgDir()}}/upgrade_abilities.svg class=tab-img-small>
                        <span class=tab-name>&nbsp;Abilities</span></a>
                    </li>
                  </ul>
                  <div class=tab-content ng-if="tabUpg.isSelected('Main')">
                    <table class="table table-condensed table-hover table-td-valign">
                      <tr>
                        <th width=20%>Name</th>
                        <th width=25% class=text-center>Level</th>
                        <th width=30% class=text-center>Value</th>
                        <th width=25% class=text-center>Upgrade</th></tr>
                      <tr>
                        <td>Capacity
                          <span class="glyphicon glyphicon-flash"></span></td>
                        <td></td>
                        <td class=text-center>{{energyMaxDC() | bignum:0:1}}
                          <br>
                          <small>+{{upgCtr.capacityUpgradeIncDC() | bignum:0:1}}</small></td>
                        <td class=text-center>
                          <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!upgCtr.canUpgradeCapacity() ng-click=upgCtr.upgradeCapacity()>
                            <span class="glyphicon glyphicon-flash"></span>{{upgCtr.getUpgradeCapacityPriceDC() | bignum:2}}</button>
                          <small>Use
                            <span class="glyphicon glyphicon-flash"></span>percentage:</small>
                          <div class="btn-group btn-group-xs btn-group-justified" role=group ng-controller="BuyAmountController as buyAmount">
                            <div class="btn-group btn-group-xs" role=group ng-repeat="buyItem in buyAmount.buyAmountRelList" ng-if="buyItem.value>0">
                              <button type=button class="btn btn-primary" ng-disabled=!upgCtr.canUpgradeCapacityAmount(buyItem.value) ng-click=upgCtr.upgradeCapacityAmount(buyItem.value)>{{buyItem.text}}</button></div>
                          </div>
                        </td>
                      </tr>
                      <tr ng-repeat-start="tube in tubes() track by $index" ng-if="!tube.active && tubes()[$index-1].active">
                        <td colspan=4>
                          <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!upgCtr.canBuyTube($index) ng-click=upgCtr.buyTube($index)>Buy tube {{$index + 1}} for
                            <span class="glyphicon glyphicon-flash"></span>{{upgCtr.getTubeBuyPriceDC($index) | bignum:2}}</button></td>
                      </tr>
                      <tr ng-repeat-end ng-if=tube.active ng-style=upgCtr.getUpgradeColorStyle($index)>
                        <td class=upgrade-cell>Amplifier {{$index+1}}
                          <sup ng-if="tube.improvementLevel > 0">{{tube.improvementLevel + 1}}</sup>
                          <button ng-show=upgCtr.isTubeImproveButtonVisible($index) type=button class="btn btn-success btn-xs btn-block animate-fade" ng-disabled=!upgCtr.canImproveTube($index) ng-click=upgCtr.improveTube($index) ng-bind-html=upgCtr.getImproveText($index) title="Improvement price: {{upgCtr.getTubeImprovePriceDC($index) | bignum}}"></button>
                        </td>
                        <td class=text-center>{{upgCtr.getTubeAmplifierLevel($index)}}
                          <small>+{{upgCtr.getTubeAmplifierLevelUpgradeInc($index)}}</small>
                          <br>
                          <uibm-progressbar value=upgCtr.getTubeAmplifierLevelsFromPrevSuperUpgrade($index) max=upgCtr.getTubeAmplifierLevelSuperUpgradeStep()>&times;{{upgCtr.getTubeAmplifierNextSuperMult($index) | bignum:0:0}}</uibm-progressbar></td>
                        <td class=text-center>
                          <span ng-bind-html=upgCtr.getAmplifierPrefix()></span>{{upgCtr.getTubeAmplifierValue($index) | bignum:(upgCtr.isShowAmplifierValueAsMult() ? 0 : 2):1}}
                          <br>
                          <small>+
                            <span ng-if=!upgCtr.isShowAmplifierValueAsMult()>
                              <span class="glyphicon glyphicon-flash"></span></span>{{upgCtr.getTubeAmplifierIncDC($index) | bignum:(upgCtr.isShowAmplifierValueAsMult() ? 0 : 2):1}}</small>
                        </td>
                        <td>
                          <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!upgCtr.isTubeAmplifierUpgradeable($index) ng-click=upgCtr.upgradeTubeAmplifier($index)>
                            <span class="glyphicon glyphicon-flash"></span>{{upgCtr.getTubeAmplifierUpgradePriceDC($index) | bignum:2}}</button>
                        </td>
                      </tr>
                      <tr>
                        <td colspan=4 class=text-center>
                          <i>Show amplifier's value as</i>&nbsp;
                          <div class="btn-group btn-group-xs" role=group>
                            <button type=button class="btn btn-default" ng-class={active:upgCtr.isShowAmplifierValueAsMult()} ng-click=upgCtr.setShowAmplifierValueAsMult(true)>multiplier</button>
                            <button type=button class="btn btn-default" ng-class={active:!upgCtr.isShowAmplifierValueAsMult()} ng-click=upgCtr.setShowAmplifierValueAsMult(false)>energy</button></div>
                          <br>
                          <small>
                            <i>Use</i>
                            <span class=text-primary>[Shift]</span>+
                            <span class=text-primary>[1]</span>-
                            <span class=text-primary>[Shift]</span>+
                            <span class=text-primary>[6]</span>
                            <i>to buy corresponding upgrades,</i>
                            <span class=text-primary>[`]</span>
                            <i>to max upgrade capacity.</i>
                          </small>
                          <br>
                          <small class=animate-fade ng-show=upgCtr.isAbilitiesTabVisible()>
                            <span class=text-primary>[Shift]</span>+
                            <span class=text-success>Improve</span>=
                            <span class=text-warning>Regress</span>
                            <i>(revert the tube to the previous state before last improve).</i>
                          </small>
                        </td>
                      </tr>
                    </table>
                  </div>
                  <div class=tab-content ng-if="tabUpg.isSelected('BallBounce')">
                    <table class="table table-condensed table-hover table-td-valign">
                      <tr>
                        <th width=20%>Name</th>
                        <th width=55% class=text-center>Ball bounce rate</th>
                        <th width=25% class=text-center>Upgrade</th></tr>
                      <tr ng-repeat="ball in balls() track by $index" ng-if=ball.active ng-style=upgCtr.getUpgradeColorStyle($index)>
                        <td class=upgrade-cell>Ball {{$index+1}}</td>
                        <td class=text-center>{{upgCtr.getBallBounceCnt($index) | bignum:0:3}}
                          <small>+{{upgCtr.getBallBounceUpgradeInc($index) | bignum:0:3}}</small>
                          <br>
                          <small>
                            <i>Est. time: {{upgCtr.getBallBounceTime($index)}}</i>
                          </small>
                        </td>
                        <td>
                          <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!upgCtr.isBallBounceUpgradeable($index) ng-click=upgCtr.upgradeBallBounce($index)>
                            <span class="glyphicon glyphicon-flash"></span>{{upgCtr.getBallBounceUpgradePriceDC($index) | bignum:2}}</button>
                        </td>
                      </tr>
                    </table>
                  </div>
                  <div class=tab-content ng-if="tabUpg.isSelected('BallSize')">
                    <table class="table table-condensed table-hover table-td-valign">
                      <tr>
                        <th width=20%>Name</th>
                        <th width=55% class=text-center>Ball size (radius)</th>
                        <th width=25% class=text-center>Upgrade</th></tr>
                      <tr ng-repeat="ball in balls() track by $index" ng-if=ball.active ng-style=upgCtr.getUpgradeColorStyle($index)>
                        <td class=upgrade-cell>Ball {{$index+1}}</td>
                        <td class=text-center>{{ball.r}}
                          <small ng-if=!upgCtr.isBallSizeMax($index)>+{{upgCtr.getBallSizeUpgradeInc($index)}}</small>(max
                          <span ng-if=!upgCtr.isBallSizeMax($index)>{{upgCtr.getBallSizeMax($index)}}</span>)</td>
                        <td>
                          <button type=button class="btn btn-primary btn-sm btn-block" ng-if=!upgCtr.isBallSizeMax($index) ng-disabled=!upgCtr.isBallSizeUpgradeable($index) ng-click=upgCtr.upgradeBallSize($index)>
                            <span class="glyphicon glyphicon-flash"></span>{{upgCtr.getBallSizeUpgradePriceDC($index) | bignum:2}}</button>
                        </td>
                      </tr>
                      <tr>
                        <td colspan=3>
                          <i>Hint: increase radius &times;2 => increase energy &times;8</i>
                        </td>
                      </tr>
                    </table>
                  </div>
                  <div class=tab-content ng-if="tabUpg.isSelected('TubeHeight')">
                    <table class="table table-condensed table-hover table-td-valign">
                      <tr>
                        <th width=20%>Name</th>
                        <th width=55% class=text-center>Tube height</th>
                        <th width=25% class=text-center>Upgrade</th></tr>
                      <tr ng-repeat="tube in tubes() track by $index" ng-if=tube.active ng-style=upgCtr.getUpgradeColorStyle($index)>
                        <td class=upgrade-cell>Tube {{$index+1}}</td>
                        <td class=text-center>{{tube.height}}
                          <small ng-if=!upgCtr.isTubeHeightMax($index)>+{{upgCtr.getTubeHeightUpgradeInc($index)}}</small>(max
                          <span ng-if=!upgCtr.isTubeHeightMax($index)>{{upgCtr.getTubeHeightMax()}}</span>)</td>
                        <td>
                          <button type=button class="btn btn-primary btn-sm btn-block" ng-if=!upgCtr.isTubeHeightMax($index) ng-disabled=!upgCtr.isTubeHeightUpgradeable($index) ng-click=upgCtr.upgradeTubeHeight($index)>
                            <span class="glyphicon glyphicon-flash"></span>{{upgCtr.getTubeHeightUpgradePriceDC($index) | bignum:2}}</button>
                        </td>
                      </tr>
                      <tr>
                        <td colspan=3>
                          <i>Hint: increase height &times;2 => increase energy &times;2</i>
                        </td>
                      </tr>
                    </table>
                  </div>
                  <div class=tab-content ng-if="upgCtr.isAbilitiesTabVisible() && tabUpg.isSelected('Abilities')">
                    <table class="table table-condensed table-hover table-td-valign" ng-controller="AbilitiesController as abilCtr">
                      <tr>
                        <th width=15%>Name</th>
                        <th width=20% class=text-center>Ability</th>
                        <th width=15% class=text-center>Points</th>
                        <th width=35% class=text-center>Drop height</th>
                        <th width=15% class=text-center>Change</th></tr>
                      <tr ng-repeat="ability in abilities() track by $index" ng-if=tubes()[$index].active ng-style=upgCtr.getUpgradeColorStyle($index)>
                        <td class=upgrade-cell>Tube {{$index+1}}</td>
                        <td class=text-center ng-bind=abilCtr.getActiveAbilityName($index)></td>
                        <td class=text-center ng-bind=abilCtr.getAbilityPoints($index)></td>
                        <td class=text-center>
                          <span ng-if=abilCtr.isAnyAbilityActive($index)>
                            <uibm-progressbar type=no-transition value=abilCtr.getTotalDropHeightDC($index) max=abilCtr.getActiveAbilityHeightMaxDC($index)>{{abilCtr.getTotalDropHeightDC($index) | bignum:0:2}} / {{abilCtr.getActiveAbilityHeightMaxDC($index) | bignum:0:2}}</uibm-progressbar>
                            <small>
                              <i>Est. time:
                                <span ng-if=abilCtr.getActiveAbilityEstTime($index)>{{abilCtr.getActiveAbilityEstTimeStr($index)}}</span>
                                <span ng-if=!abilCtr.getActiveAbilityEstTime($index)>infinity</span></i>
                            </small>
                          </span>
                        </td>
                        <td>
                          <button type=button class="btn btn-primary btn-sm btn-block" ng-click=abilCtr.showTubeAbilityDlg($index)>Change...</button></td>
                      </tr>
                    </table>
                  </div>
                </section>
              </div>
              <div class=tab-content ng-if="tab.isSelected('Reset')" ng-controller="ResetController as rstCtr">
                <div class=content-block ng-controller="BuyAmountController as buyAmount">
                  <small>
                    <span ng-if=!buyAmount.isBuyAmountStepPosRight()>
                      <b>Step</b>:
                      <div class="btn-group btn-group-xs" role=group>
                        <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountStepList" ng-class="{active:buyAmount.getBuyAmountObject().step==item}" ng-click=buyAmount.setBuyAmountValueStep(item) title={{buyAmount.getBuyAmountStepHotKey(itemId)}}>{{item}}</button></div>&nbsp;</span>
                    <b>Buy amount</b>:
                    <div class="btn-group btn-group-xs" role=group>
                      <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountRelList" ng-class="{active:buyAmount.getBuyAmountObject().rel==item.value}" ng-click=buyAmount.setBuyAmountValueRel(item.value) title={{buyAmount.getBuyAmountRelHotKey(itemId)}}>{{item.text}}</button></div>
                    <span ng-if=buyAmount.isBuyAmountStepPosRight()>&nbsp;
                      <b>Step</b>:
                      <div class="btn-group btn-group-xs" role=group>
                        <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountStepList" ng-class="{active:buyAmount.getBuyAmountObject().step==item}" ng-click=buyAmount.setBuyAmountValueStep(item) title={{buyAmount.getBuyAmountStepHotKey(itemId)}}>{{item}}</button></div>
                    </span>
                  </small>
                </div>
                <center>
                  <button type=button class="btn btn-info" ng-disabled=!rstCtr.canProcessReset() ng-click=rstCtr.showResetSystemDialog()>Activate
                    <b>{{getInactiveMetaEnergy() | bignum:2}}</b>meta-energy</button>
                  <div>
                    <span ng-if="rstCtr.getResetCnt() == 0">
                      <span class=num>15</span>-
                      <span class=num>20</span>meta-energy recommended for first meta-energy activation.
                      <br></span>
                    <span ng-show=rstCtr.isShowEnergyRemain() class=animate-fade>Generate
                      <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getEnergyToStartAccumulateMetaDC() | bignum}} more to start accumulating meta-energy.</span>
                    <br>You have
                    <span class=num>
                      <b>{{rstCtr.getActive() | bignum:2}}</b>
                    </span>meta-energy
                    <span ng-if="rstCtr.getActive()>0">, and now you can use it to change the world!
                      <br>Meta-energy adds
                      <span class=num>+{{rstCtr.getTotalBonusMultPerc() | bignum:2}}%</span>to the gathered energy.</span>
                    <br>
                    <small>
                      <i class=animate-fade ng-show=rstCtr.isAnyResetUpgradeBought()>You can refund all meta-upgrades in the Shop using
                        <b>Meta-energy refund</b>.</i>&nbsp;</small>
                  </div>
                </center>
                <div class=scroll-section-reset>
                  <table class="table table-condensed table-hover table-td-valign table-no-bottom-margin">
                    <tr>
                      <th width=45%>Name</th>
                      <th width=30% class=text-center>Value</th>
                      <th width=25% class=text-center>Buy</th></tr>
                    <tr>
                      <td>Auto-capacity extender
                        <br>
                        <small>
                          <i>increase capacity on energy overflow</i>
                        </small>
                      </td>
                      <td class=text-center>
                        <span class=animate-fade ng-show="rstCtr.getResetEnergyExtLevel() > 0">{{rstCtr.getEnergyExtCapacityMult() | bignum:2}}%
                          <br>
                          <small>+{{rstCtr.getResetEnergyExtUpgradeInc() | bignum:2}}%</small>
                          <br>
                          <small>
                            <i>of manual upgrade</i>
                          </small>
                        </span>
                      </td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetEnergyExtUpgradeable() ng-click=rstCtr.upgradeResetEnergyExt()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetEnergyExtUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                    <tr>
                      <td>Bounce</td>
                      <td class=text-center>&times;{{rstCtr.getBounceMult() | bignum}}
                        <br>
                        <small>+{{rstCtr.getResetBounceUpgradeInc() | bignum}}</small></td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetBounceUpgradeable() ng-click=rstCtr.upgradeResetBounce()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetBounceUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                    <tr>
                      <td>Density
                        <br>
                        <small>
                          <i>density &times;2 => energy &times;2</i>
                        </small>
                      </td>
                      <td class=text-center>&times;{{rstCtr.getDensityMult() | bignum}}
                        <br>
                        <small>+{{rstCtr.getResetDensityUpgradeInc() | bignum}}</small></td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetDensityUpgradeable() ng-click=rstCtr.upgradeResetDensity()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetDensityUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                    <tr>
                      <td>Gravity
                        <br>
                        <small>
                          <i>gravity &times;2 => energy &times;2 & speed &times;1.4</i>
                        </small>
                      </td>
                      <td class=text-center>&times;{{rstCtr.getGravityMult() | bignum:2}}
                        <br>
                        <small>+{{rstCtr.getResetGravityUpgradeInc() | bignum:2}}%</small></td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetGravityUpgradeable() ng-click=rstCtr.upgradeResetGravity()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetGravityUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                    <tr>
                      <td>Bubble probability</td>
                      <td class=text-center>{{rstCtr.getBubbleProb() | bignum:2}}%
                        <br>
                        <small>+{{rstCtr.getResetBubbleProbUpgradeInc() | bignum:2}}%</small></td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetBubbleProbUpgradeable() ng-click=rstCtr.upgradeResetBubbleProb()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetBubbleProbUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                    <tr>
                      <td>Bubble initial capacity</td>
                      <td class=text-center>&times;{{rstCtr.getBubbleCapMult() | bignum:2}}
                        <br>
                        <small>+{{rstCtr.getResetBubbleCapUpgradeInc() | bignum:2}}</small></td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetBubbleCapUpgradeable() ng-click=rstCtr.upgradeResetBubbleCap()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetBubbleCapUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                    <tr class=animate-fade ng-hide=rstCtr.isResetRemoveSpikesBought()>
                      <td colspan=2>Remove spikes
                        <span class=spikes>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>above the energy bar
                        <br>
                        <small>
                          <i>bubble will grow ~1 second longer</i>
                        </small>
                      </td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetRemoveSpikeUpgradeable() ng-click=rstCtr.upgradeResetRemoveSpikes()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetRemoveSpikesPrice() | bignum:2}}</button></td>
                    </tr>
                    <tr>
                      <td>Idle bonus multiplier
                        <a href="index.html#" ng-click=showIdleModeHelp() m-prevent-default>
                          <span class="glyphicon glyphicon-question-sign"></span></a>
                        <br>
                        <small>
                          <i>increase idle energy per hour</i>
                        </small>
                      </td>
                      <td class=text-center>&times;{{rstCtr.getIdleMult() | bignum:2}}
                        <br>
                        <small>+{{rstCtr.getResetIdleMultUpgradeInc() | bignum:2}}</small></td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetIdleMultUpgradeable() ng-click=rstCtr.upgradeResetIdleMult()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetIdleMultUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                    <tr>
                      <td>Idle multiplier growth time
                        <br>
                        <small>
                          <i>idle multiplier grows during this time</i>
                        </small>
                      </td>
                      <td class=text-center>{{rstCtr.getIdleMultTime() | bignum}} hour(s)
                        <br>
                        <small>+{{rstCtr.getResetIdleMultTimeUpgradeInc() | bignum}}</small></td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetIdleMultTimeUpgradeable() ng-click=rstCtr.upgradeResetIdleMultTime()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetIdleMultTimeUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                    <tr>
                      <td>Energy generator
                        <span ng-if=rstCtr.isResetEnergyGeneratorAvailable()>{{rstCtr.getResetEnergyGeneratorLevel()}}
                          <small>+{{rstCtr.getResetEnergyGeneratorLevelUpgradeInc()}}</small>[{{rstCtr.getResetEnergyGeneratorLevelMax()}}]</span>
                        <br>
                        <small>
                          <i ng-if=!rstCtr.isResetEnergyGeneratorAvailable()>Improve any tube to N
                            <sup>{{rstCtr.getResetEnergyGeneratorNextTubeImproveLevel()}}</sup>to buy</i>
                          <i ng-if=rstCtr.isResetEnergyGeneratorAvailable()>Next max level increase: any tube N
                            <sup>{{rstCtr.getResetEnergyGeneratorNextTubeImproveLevel()}}</sup></i>
                        </small>
                      </td>
                      <td class=text-center>
                        <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetEnergyGeneratorValueDC() | bignum:0:1}}/sec
                        <br>
                        <small>{{rstCtr.getResetEnergyGeneratorVisualValueAfterUpgradeDC() | bignum:0:1}}</small></td>
                      <td>
                        <button type=button class="btn btn-primary btn-sm btn-block" ng-disabled=!rstCtr.isResetEnergyGeneratorUpgradeable() ng-click=rstCtr.upgradeResetEnergyGenerator()>Meta
                          <span class="glyphicon glyphicon-flash"></span>{{rstCtr.getResetEnergyGeneratorUpgradePrice() | bignum:2}}</button></td>
                    </tr>
                  </table>
                </div>
              </div>
              <div class="tab-content scroll-section" ng-if="tab.isSelected('Achievements')" ng-controller="AchievementsController as achCtr">
                <div ng-repeat="item in achCtr.achievementList" class="list-group list-group-small-gap">
                  <div class="list-group-item list-group-item-warning">
                    <h4 class=list-group-item-heading>{{item.name}} {{achCtr.achievementsLevel()[$index] | bignum}}
                      <span ng-if=item.levelMax>/ {{item.levelMax}}</span></h4>
                    <p class=list-group-item-text ng-bind-html=item.descr></p>
                    <p class=list-group-item-text ng-if="!item.hideMult && achCtr.achievementsMult()[$index]">
                      <i>Current multiplier: &times;{{achCtr.achievementsMult()[$index] | bignum:item.multDecDigits}}</i>
                    </p>
                    <uibm-progressbar ng-if=!achCtr.isAchievementLevelCap($index) value=achCtr.achievementStatsDC()[$index] max=achCtr.getAchievementReq($index)>{{achCtr.achievementStatsDC()[$index] | bignum}} / {{achCtr.getAchievementReq($index) | bignum}}</uibm-progressbar>
                    <p ng-if=achCtr.isAchievementLevelCap($index) class="list-group-item-text achievement-max">MAX</p></div>
                </div>
                <center>
                  <i>Each new achievement gives you
                    <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>1</i></center>
              </div>
              <div class="tab-content scroll-section" ng-if="tab.isSelected('Stats')" ng-controller="StatisticsController as statsCtr">
                <div class="panel panel-default">
                  <div class=panel-heading>Statistics</div>
                  <div class=panel-body>
                    <span ng-repeat="(key, item) in statsCtr.statisticsList()">
                      <b>{{item.name}}</b>:
                      <span ng-if="key!='time'">{{statsCtr.statistics()[key] | bignum:item.bigNumLoDigits}}</span>
                      <span ng-if="key=='time'">{{statsCtr.getActiveTime()}}</span>
                      <span ng-if=item.showRank>(score: {{statsCtr.getBigValueDCRank(statsCtr.statistics()[key]) | number:0}})</span>
                      <br></span>
                    <span>
                      <b>Days played in a row so far</b>: {{statsCtr.getDaysPlayedInRow()}}</span>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class=panel-heading>Total multipliers</div>
                  <div class=panel-body>
                    <b>Energy</b>: &times;{{statsCtr.getTotalEnergyMult() | bignum:2}}
                    <br>
                    <b>Gravity</b>: &times;{{statsCtr.getTotalGravityMult() | bignum:2}}
                    <br>
                    <b>Bounce</b>: &times;{{statsCtr.getTotalBounceMult() | bignum}}
                    <br>
                    <b>Idle bonus multiplier</b>: &times;{{statsCtr.getIdleEnergyMultTotal() | bignum:2}} / hour
                    <br>
                    <b>Idle multiplier growth time</b>: {{statsCtr.getIdleEnergyMultTimeTotal() | bignum}} hour(s)
                    <br>
                    <span ng-if="statsCtr.getIdleEnergyMultTotal() > 0">
                      <b>Maximal idle bonus multiplier</b>: x{{statsCtr.getIdleEnergyMultMaxDC() | bignum:2}}
                      <br></span>
                    <span ng-if=statsCtr.isBoostDailyActive()>
                      <b>Daily reward</b>: {{statsCtr.getBoostDailyType()}} +{{statsCtr.getBoostDailyTotalValue() | number:1}}% duration {{statsCtr.getBoostDailyDuration()}}</span>
                  </div>
                </div>
              </div>
              <div class=tab-content ng-if="tab.isSelected('Events')" ng-controller="EventsController as evCtr">
                <div class="panel panel-info">
                  <div class="panel-heading premium-info-panel">
                    <div class=row>
                      <div class="col-xs-3 small">
                        <table class="table premium-info-table table-no-lines table-no-bottom-margin">
                          <tr>
                            <td width=1%>Gravity:</td>
                            <td>+{{evCtr.eventsGravityPerc()}}%</td></tr>
                          <tr>
                            <td>Bounce:</td>
                            <td>+{{evCtr.eventsBouncePerc()}}%</td></tr>
                          <tr>
                            <td>Energy:</td>
                            <td>+{{evCtr.eventsEnergyPerc()}}%</td></tr>
                          <tr>
                            <td style=white-space:nowrap>Idle bonus:</td>
                            <td>+{{evCtr.eventsIdleMultPerc()}}%</td></tr>
                          <tr>
                            <td style=white-space:nowrap>Idle time:</td>
                            <td>+{{evCtr.eventsIdleMultTimePerc()}}%</td></tr>
                          <tr>
                            <td style=white-space:nowrap>Meta bonus:</td>
                            <td>+{{evCtr.eventsMetaBonusIncPerc()}}%</td></tr>
                        </table>
                      </div>
                      <div class=col-xs-9>
                        <div ng-if=evCtr.isEventActive() class=text-center>
                          <button class="btn btn-info btn-lg" ng-click=evCtr.eventOpen()>Start {{evCtr.getEventTitle()}}</button>
                          <br>
                          <small>Event ends in {{evCtr.getEventTime()}}</small>
                          <br>
                          <small>
                            <i>Collect special items during event to get permanent boosts.</i>
                          </small>
                        </div>
                        <p ng-if=!evCtr.isEventActive() class=text-center>
                          <br>No active events.
                          <br>Come back later.</p></div>
                    </div>
                  </div>
                  <div class="panel-body text-center scroll-events-list">
                    <table class="table table-td-valign table-no-bottom-margin" ng-repeat="(eventListId, eventItem) in evCtr.eventList" ng-if=evCtr.isAnyEventItem(eventItem.code)>
                      <tr ng-click=evCtr.toggleEventItems(eventListId)>
                        <td>
                          <table class="table-hover table-td-valign table-no-bottom-margin">
                            <td width=3% ng-bind=evCtr.getToggleButtonText(eventListId)></td>
                            <td width=1%>
                              <div class="event-img-wrap pull-left">
                                <img ng-repeat="(key, item) in evCtr.eventItemList" ng-src={{item.img}} class=event-img ng-style="{'z-index':100-key}" ng-if="evCtr.isEventItemActive(key) && eventItem.code==item.eventCode"></div>
                            </td>
                            <td>
                              <b>{{eventItem.title}}</b>
                            </td>
                          </table>
                        </td>
                      </tr>
                      <tr>
                        <td ng-show=evCtr.eventItemsExpanded[eventListId] class=animate-slide>
                          <table class="table table-hover table-td-valign table-no-bottom-margin">
                            <tr ng-repeat="(key, item) in evCtr.eventItemList" ng-if="evCtr.isEventItemActive(key) && eventItem.code==item.eventCode">
                              <td>
                                <img ng-src={{item.imgIcon}} class=event-item-img></td>
                              <td class=text-left>
                                <b>{{item.title}}</b>
                              </td>
                              <td class="small text-left" ng-bind-html=item.desc></td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>
              <div class="tab-content scroll-section" ng-if="tab.isSelected('Settings')" ng-controller="SettingsController as setsCtr">
                <div class=content-block>
                  <b>Number format</b>:&nbsp;
                  <div class="btn-group btn-group-xs" role=group>
                    <button type=button class="btn btn-default" ng-class="{active:setsCtr.getNumNotation()=='suffix'}" ng-click="setsCtr.setNumNotation('suffix')">Standard</button>
                    <button type=button class="btn btn-default" ng-class="{active:setsCtr.getNumNotation()=='sci'}" ng-click="setsCtr.setNumNotation('sci')">Scientific</button>
                    <button type=button class="btn btn-default" ng-class="{active:setsCtr.getNumNotation()=='engineering'}" ng-click="setsCtr.setNumNotation('engineering')">Engineering</button></div>
                </div>Example: {{1e11+1 | bignum}}
                <hr class=settings-div>
                <div class=content-block>
                  <table class="table table-condensed table-no-lines table-td-valign table-no-bottom-margin">
                    <td width=30%>
                      <div class=checkbox>
                        <label>
                          <input type=checkbox ng-model=setsCtr.sfxEnabled ng-init=setsCtr.getSfxEnabled() ng-change=setsCtr.setSfxEnabled()>Sound effects</label></div>
                    </td>
                    <td valign=center>
                      <input type=range min=0 max=100 ng-model=setsCtr.sfxVolume ng-init=setsCtr.getSfxVolume() ng-change=setsCtr.setSfxVolume()></td>
                  </table>
                  <table class="table table-condensed table-no-lines table-td-valign table-no-bottom-margin">
                    <td width=30%>
                      <div class=checkbox>
                        <label>
                          <input type=checkbox ng-model=setsCtr.musicEnabled ng-init=setsCtr.getMusicEnabled() ng-change=setsCtr.setMusicEnabled()>Music</label></div>
                    </td>
                    <td valign=center>
                      <input type=range min=0 max=100 ng-model=setsCtr.musicVolume ng-init=setsCtr.getMusicVolume() ng-change=setsCtr.setMusicVolume()></td>
                  </table>
                  <div class=checkbox ng-if=isSteamVersion>
                    <label>
                      <input type=checkbox ng-model=setsCtr.fullscreen ng-init=setsCtr.getFullScreen() ng-change=setsCtr.setFullScreen()>Full screen</label></div>
                  <div class=checkbox ng-if=isSteamVersion>
                    <label>
                      <input type=checkbox ng-model=setsCtr.keepWindowSize ng-init=setsCtr.getKeepWindowSize() ng-change=setsCtr.setKeepWindowSize()>Keep window size after restart</label></div>
                  <div class=checkbox>
                    <label>
                      <input type=checkbox ng-model=setsCtr.showBounceEnergy ng-init=setsCtr.getShowBounceEnergy() ng-change=setsCtr.setShowBounceEnergy()>Show energy value on every bounce</label></div>
                  <div class=checkbox>
                    <label>
                      <input type=checkbox ng-model=setsCtr.coloredUpgrades ng-init=setsCtr.getColoredUpgrades() ng-change=setsCtr.setColoredUpgrades()>Colored upgrades</label></div>
                  <div class=checkbox>
                    <label>
                      <input type=checkbox ng-model=setsCtr.showUpgradeCntInTab ng-init=setsCtr.getShowUpgradeCntInTab() ng-change=setsCtr.setShowUpgradeCntInTab()>Show the number of available upgrades in the tabs</label></div>
                  <div class=checkbox>
                    <label>
                      <input type=checkbox ng-model=setsCtr.showAbilityEffects ng-init=setsCtr.getShowAbilityEffects() ng-change=setsCtr.setShowAbilityEffects()>Show ability effects</label></div>
                </div>
                <div class=content-block ng-if=setsCtr.showBallStyles()>
                  <b>Improved ball style</b>:&nbsp;
                  <div class="btn-group btn-group-xs" role=group>
                    <button ng-repeat="(key, item) in setsCtr.ballStyleList" ng-if="item.type=='vector'" type=button class="btn btn-default" ng-class="{active:setsCtr.getBallStyle()==key}" ng-click=setsCtr.setBallStyle(key)>{{item.name}}</button></div>&nbsp;
                  <div class="btn-group btn-group-xs" role=group>
                    <button ng-repeat="(key, item) in setsCtr.ballStyleList" ng-if="item.type=='bitmap'" type=button class="btn btn-default" ng-class="{active:setsCtr.getBallStyle()==key}" ng-click=setsCtr.setBallStyle(key)>{{item.name}}</button></div>
                </div>
                <div class=content-block>
                  <b>Background style</b>:&nbsp;
                  <div class="btn-group btn-group-xs" role=group>
                    <button ng-repeat="item in setsCtr.bgStyles" type=button class="btn btn-default" ng-class="{active:setsCtr.getBgStyle()==item}" ng-click=setsCtr.setBgStyle(item) ng-bind=item></button></div>
                </div>
                <div class=content-block>
                  <table class="table table-condensed table-no-lines table-td-valign table-no-bottom-margin">
                    <tr>
                      <td width=1%>
                        <label for=theme>Theme:</label></td>
                      <td>
                        <select class=form-control id=theme ng-model=setsCtr.selectedTheme ng-change=setsCtr.onThemeChanged()>
                          <option ng-repeat="(key, item) in setsCtr.themeList" ng-value=key>{{item.name}}</option></select>
                      </td>
                    </tr>
                  </table>
                </div>
                <div class=content-block>
                  <b>Buy amount step position</b>:&nbsp;
                  <div class="btn-group btn-group-xs" role=group>
                    <button type=button class="btn btn-default" ng-class={active:!setsCtr.isBuyAmountStepPosRight()} ng-click=setsCtr.setBuyAmountStepPosRight(false)>left</button>
                    <button type=button class="btn btn-default" ng-class={active:setsCtr.isBuyAmountStepPosRight()} ng-click=setsCtr.setBuyAmountStepPosRight(true)>right</button></div>
                </div>
                <hr class=settings-div>
                <div class=content-block>
                  <div class=pull-left>
                    <button type=button class="btn btn-default btn-xs" ng-disabled=setsCtr.showHardResetDlg ng-click=setsCtr.hardResetDlg()>Hard reset game</button>&nbsp;
                    <span class=animate-fade ng-show=setsCtr.showHardResetDlg>
                      <b>Are you sure?</b>
                      <button type=button class="btn btn-danger btn-xs" ng-click=setsCtr.hardResetConfirm(true)>Yes</button>
                      <button type=button class="btn btn-default btn-xs" ng-click=setsCtr.hardResetConfirm(false)>Cancel</button></span>
                  </div>
                  <div class=text-right>
                    <button type=button class="btn btn-xs btn-default" ng-if=isKongregateVersion ng-click=reloadGame()>Reload game</button>
                    <button type=button class="btn btn-xs" ng-if=!isKongregateVersion ng-class=setsCtr.getSaveButtonStyle() ng-disabled=setsCtr.isSaveResultVisible() ng-click=setsCtr.saveGame() ng-bind=setsCtr.getSaveButtonText()></button>
                  </div>
                  <div class=clear-float></div>
                </div>
                <hr class=settings-div ng-if=isKongregateVersion>
                <div class=content-block ng-if=isKongregateVersion>
                  <div class=pull-left>
                    <button type=button class="btn btn-default btn-xs" ng-click=setsCtr.showCloudDialog()>Cloud save/load</button></div>
                  <div class=text-right>
                    <button type=button class="btn btn-xs" ng-class=setsCtr.getSaveButtonStyle() ng-disabled=setsCtr.isSaveResultVisible() ng-click=setsCtr.saveGame() ng-bind=setsCtr.getSaveButtonText()></button>
                  </div>
                  <div class=clear-float></div>
                  <small class=text-danger ng-if=isKongregateVersion>
                    <i>Cloud save/load is manual only, no auto-saving/loading yet!</i>
                  </small>
                </div>
                <hr class=settings-div>
                <div class=content-block>
                  <div class=form-group ng-class="{'has-error':!setsCtr.saveStrOk}">
                    <label>Export/import saved data</label>
                    <p>
                      <input class=form-control type=text ng-model=setsCtr.serializedSaveStr ng-init=setsCtr.updateSaveStr() ng-change=setsCtr.buttonLoadFromStr() ng-click=setsCtr.selectOnClick($event) placeholder="Export/import save data"></p>
                    <p ng-if=setsCtr.isShowImportWarning() class=alert-danger>
                      <b>WARNING</b>: You should be logged in to {{isSteamVersion ? 'Steam' : 'kongregate'}} with the same user to be able to import this save data!</p>
                    <p>To export, click the text above and copy (ctrl-c). To import, click the text and paste (ctrl-v) your exported data.</p>
                    <p>It's normal for imported saves to have more energy and other stats than you exported with. Your tubes continue their work even after saved data is exported/before it's imported.</p>
                  </div>
                </div>
                <hr class=settings-div>
                <div class=content-block>
                  <p>
                    <b>Idle Bouncer</b>
                    <small>v. {{gameVer}}</small></p>
                  <p>Some icons provided by http://game-icons.net</p>
                </div>
                <hr class=settings-div></div>
              <div class=tab-content ng-if="tab.isSelected('Premium')" ng-controller="PremiumController as premCtr">
                <div class="panel panel-warning">
                  <div class="panel-heading premium-info-panel">
                    <div class=row>
                      <div class="col-xs-5 small">
                        <table class="table premium-info-table table-no-lines table-no-bottom-margin">
                          <tr>
                            <td width=1%>Gravity:</td>
                            <td>+{{premCtr.premiumGravityPerc()}}%</td></tr>
                          <tr>
                            <td>Bounce:</td>
                            <td>+{{premCtr.premiumBouncePerc()}}%</td></tr>
                          <tr>
                            <td>Energy:</td>
                            <td>+{{premCtr.premiumEnergyPerc()}}%</td></tr>
                          <tr>
                            <td style=white-space:nowrap>Idle bonus:</td>
                            <td>+{{premCtr.premiumIdleMultPerc()}}%</td></tr>
                          <tr>
                            <td style=white-space:nowrap>Idle time:</td>
                            <td>+{{premCtr.premiumIdleMultTimePerc()}}%</td></tr>
                          <tr>
                            <td style=white-space:nowrap>Energy generator:</td>
                            <td>{{premCtr.premiumEnergyGeneratorStr()}}</td></tr>
                        </table>
                      </div>
                      <div class=col-xs-7>
                        <h4>
                          <b>You have
                            <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal>{{premCtr.premiumMoney()}}</b>&nbsp;
                          <button class="btn btn-warning btn-sm" ng-click=premCtr.showPremiumDialog()>&nbsp;
                            <span class="glyphicon glyphicon-plus"></span>&nbsp;</button></h4>
                      </div>
                    </div>
                    <small>
                      <i>Shop bonuses are multiplied by meta-energy bonuses</i>
                    </small>
                  </div>
                  <div class="panel-body text-center scroll-premium-list">
                    <table class="table table-hover table-td-valign table-no-bottom-margin">
                      <tr class=success ng-if="premCtr.isPremiumPackAvailable('packspec')">
                        <td style=white-space:nowrap class=text-left>
                          <b>First time buyer?</b>
                        </td>
                        <td class="small text-left">We've got special deal for you!</td>
                        <td>
                          <button type=button class="btn btn-default btn-block" ng-click=premCtr.showPremiumDialog()>Get deal</button></td>
                      </tr>
                      <tr class=success ng-if="premCtr.isPremiumPackAvailable('packidlen')">
                        <td style=white-space:nowrap class=text-left>
                          <b>Like idle play?</b>
                        </td>
                        <td class="small text-left">We've got special deal for you!</td>
                        <td>
                          <button type=button class="btn btn-default btn-block" ng-click=premCtr.showPremiumDialog()>Get deal</button></td>
                      </tr>
                      <tr ng-repeat="item in premCtr.premiumItemList" ng-if="item.active() || !item.hideInactive">
                        <td class=text-left>
                          <b>{{item.name}}</b>
                          <span ng-if=item.availCntFnc>({{item.availCntFnc()}}&nbsp;left)</span>
                          <a href="index.html#" ng-if=item.onHelpFnc ng-click=item.onHelpFnc() m-prevent-default>
                            <span class="glyphicon glyphicon-question-sign"></span>
                          </a>
                        </td>
                        <td class="small text-left" ng-bind-html="item.active() ? item.desc : item.descInactive"></td>
                        <td>
                          <button type=button class="btn btn-default btn-block" ng-disabled=!item.active() ng-click=premCtr.showPremiumConfirmDialog($index)>
                            <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>{{item.price}}</button></td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </div>
        <div ng-if=isDebugEnabled ng-controller="DebugController as dbgCtr">
          <div class="panel panel-default tutorial-highlight" style=z-index:99999>
            <div class=panel-body>
              <div class=row>
                <div class=col-sm-5>
                  <b>Skip time</b>:
                  <div class="btn-group btn-group-xs" role=group>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.skipTime(60)>1 min</button>
                    <button type=button ng-if=0 class="btn btn-default" ng-click=dbgCtr.skipTime(300)>5 min</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.skipTime(600)>10 mins</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.skipTime(3600)>1 hour</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.skipTime(86400)>1 day</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.skipTime(2592000)>1 month</button>
                    <button type=button ng-if=0 class="btn btn-default" ng-click=dbgCtr.skipTime(31536000)>1 year</button></div>
                </div>
                <div class=col-sm-7>
                  <div class="btn-group btn-group-xs" role=group>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.addEnergyMax(1e120)>MAX
                      <span class="glyphicon glyphicon-flash"></span>&times;{{1e120 | bignum}}</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.addMoney(energyMaxDC())>+
                      <span class="glyphicon glyphicon-flash"></span>{{energyMaxDC() | bignum}}</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.dbgFakeKongregateLogin()>Fake Kong login</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.dbgFakeKongregateAPIConnectionSuccess()>Fake KongAPI success</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.addPremium(100)>+
                      <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>100</button></div>
                </div>
                <div class=col-sm-12>
                  <div class=content-block>
                    <b>Game speed (relative)</b>:
                    <div class="btn-group btn-group-xs" role=group>
                      <button type=button class="btn btn-default" ng-repeat="item in dbgCtr.accelerationTimeList" ng-class="{active:dbgCtr.getAccelerationTime()==item}" ng-click=dbgCtr.setAccelerationTime(item)>&times;{{item}}</button></div>
                    <br>
                    <b>Game speed (fixed)</b>:
                    <div class="btn-group btn-group-xs" role=group>
                      <button type=button class="btn btn-default" ng-repeat="item in dbgCtr.dbgFixAccelerationList" ng-class="{active:dbgCtr.getFixAcceleration()==item}" ng-click=dbgCtr.setFixAcceleration(item)>{{item}} sec</button></div>
                  </div>
                </div>
                <div class=col-sm-4>
                  <b>Execution time</b>: {{dbgCtr.idleExecTimeLast() | number:3}} + {{dbgCtr.outsideIdleLoopExecTimeLast() | number:3}} = {{dbgCtr.execTimeLast() | number:3}}</div>
                <div class=col-sm-4>
                  <b>Max execution time</b>: {{dbgCtr.idleExecTimeMax() | number:3}} + {{dbgCtr.outsideIdleLoopExecTimeMax() | number:3}} = {{dbgCtr.execTimeMax() | number:3}}</div>
                <div class=col-sm-4>
                  <b>Save size max</b>: {{dbgCtr.saveSizeMax() | bignum:0}}</div>
                <div class=col-sm-12>
                  <b>Daily reward</b>:
                  <div class="btn-group btn-group-xs" role=group>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.addDayToDailyReward(1)>+1 day</button>
                    <button type=button class="btn btn-default" ng-click=dbgCtr.addDayToDailyReward(2)>+2 days</button></div>
                </div>
                <div class=col-sm-6>
                  <button type=button class="btn btn-default btn-xs" ng-class={active:dbgCtr.isAutoPlay()} ng-click="dbgCtr.toggleAutoPlay('')">Auto Play</button>
                  <button type=button class="btn btn-default btn-xs" ng-class={active:dbgCtr.isAutoPlaySimUser()} ng-click="dbgCtr.toggleAutoPlay('simUser')">Simulate User</button>Auto Play Time: {{dbgCtr.getAutoPlayTime() | number:1}} secs</div>
                <div class=col-sm-6>
                  <a ng-if=dbgCtr.isCsvReady() href="index.html#" ng-click=dbgCtr.onCsvClick() type=button class="btn btn-default btn-xs" m-prevent-default>Download CSV</a></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-controller="AbilitiesController as abilCtr" ng-show=abilCtr.isTubeAbilityDlgVisible()>
          <div class="modal-backdrop in" ng-click=abilCtr.hideTubeAbilityDlg()></div>
          <div class="modal-dialog full-width-dialog" ng-if=abilCtr.isTubeAbilityDlgVisible()>
            <div class=modal-content>
              <div class="modal-header modal-condensed">
                <h4 class="modal-title text-center">
                  <button type=button class="btn btn-default btn-xs" ng-disabled=abilCtr.isSelectedTubeFirst() ng-click="abilCtr.showTubeAbilityDlg(abilCtr.getSelectedTubeId() - 1)">
                    <span class="glyphicon glyphicon-triangle-left"></span>
                  </button>Tube {{abilCtr.getSelectedTubeId() + 1}}
                  <sup ng-if=tubes()[abilCtr.getSelectedTubeId()].improvementLevel>{{tubes()[abilCtr.getSelectedTubeId()].improvementLevel + 1}}</sup>abilities
                  <button type=button class="btn btn-default btn-xs" ng-disabled=abilCtr.isSelectedTubeLast() ng-click="abilCtr.showTubeAbilityDlg(abilCtr.getSelectedTubeId() + 1)">
                    <span class="glyphicon glyphicon-triangle-right"></span></button>
                </h4>
              </div>
              <div class="modal-body modal-condensed">
                <div class=text-center>Add ability to the queue to use it. Each ability requires a certain total drop height to activate (filled when ball falls down).
                  <br>You will receive
                  <span class=num>1</span>ability point for each
                  <i>new</i>improvement of this tube persistent over meta-energy activations.
                  <a href="index.html#" ng-mouseenter=abilCtr.setAbilityExampleVisible(true) ng-mouseleave=abilCtr.setAbilityExampleVisible(false) m-prevent-default>(example)</a>
                  <div class="popover bottom animate-fade" role=tooltip style=top:40px;left:650px;display:block ng-show=abilCtr.isAbilityExampleVisible()>
                    <div class=arrow style=bottom:50%;left:62%></div>
                    <h3 class=popover-title>Example</h3>
                    <div class=popover-content>Improve tube 3 times, which will give you 3 ability points. Then activate meta-energy, which resets tube improvement level, but you keep your 3 ability points. However, during first 3 improvements after meta-energy activations you will not get any new ability points, you get the 4th ability point when you improve tube for the 4th time after meta-energy activation.</div></div>
                </div>
                <div class=text-center ng-if=abilCtr.getCurrentAbilityPoints()>You have
                  <span class=num>{{abilCtr.getCurrentAbilityPoints()}}</span>ability point(s).</div>
                <div class=text-center ng-if=!abilCtr.getCurrentAbilityPoints()>You have no ability points.</div>
                <div class=text-center>
                  <small>
                    <i class=animate-fade ng-show=abilCtr.isAnyAbilityBought()>You can refund all ability upgrades in the Shop using
                      <b>Abilities refund</b>.</i>&nbsp;</small>
                </div>
                <div class=content-block ng-controller="BuyAmountController as buyAmount">
                  <small>
                    <span ng-if=!buyAmount.isBuyAmountStepPosRight()>
                      <b>Step</b>:
                      <div class="btn-group btn-group-xs" role=group>
                        <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountStepList" ng-class="{active:buyAmount.getBuyAmountObject().step==item}" ng-click=buyAmount.setBuyAmountValueStep(item) title={{buyAmount.getBuyAmountStepHotKey(itemId)}}>{{item}}</button></div>&nbsp;</span>
                    <b>Buy amount</b>:
                    <div class="btn-group btn-group-xs" role=group>
                      <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountRelList" ng-class="{active:buyAmount.getBuyAmountObject().rel==item.value}" ng-click=buyAmount.setBuyAmountValueRel(item.value) title={{buyAmount.getBuyAmountRelHotKey(itemId)}}>{{item.text}}</button></div>
                    <span ng-if=buyAmount.isBuyAmountStepPosRight()>&nbsp;
                      <b>Step</b>:
                      <div class="btn-group btn-group-xs" role=group>
                        <button type=button class="btn btn-default" ng-repeat="(itemId, item) in buyAmount.buyAmountStepList" ng-class="{active:buyAmount.getBuyAmountObject().step==item}" ng-click=buyAmount.setBuyAmountValueStep(item) title={{buyAmount.getBuyAmountStepHotKey(itemId)}}>{{item}}</button></div>
                    </span>
                  </small>
                </div>
                <div class=row>
                  <div class="col-xs-8 scroll-section-abilities">
                    <table class="table table-condensed table-hover table-td-valign">
                      <tr>
                        <th width=30%>Ability</th>
                        <th class=text-center width=20%>Level</th>
                        <th class=text-center width=15%>Activation drop height</th>
                        <th class=text-center width=15%>Effect</th>
                        <th class=text-center width=10%>Buy</th>
                        <th class=text-center width=10%>To queue</th></tr>
                      <tr ng-repeat-start="(key, item) in abilCtr.abilityList" ng-if=abilCtr.isCurrentAbilityCanBeBought(key)>
                        <td>
                          <b ng-bind=item.name></b>
                          <a href="index.html#" ng-click=abilCtr.toggleAbilityDescrVisible(key) m-prevent-default>
                            <span class="glyphicon glyphicon-question-sign"></span>
                          </a>
                          <div class=animate-slide ng-show=abilCtr.isAbilityDescrVisible(key)>
                            <small ng-bind-html=abilCtr.getCurrentAbilityDescr(key)></small>
                          </div>
                        </td>
                        <td class=text-center>{{abilCtr.getCurrentAbilityLevel(key)}}
                          <span ng-if=!abilCtr.isCurrentAbilityLevelMax(key)>/ {{abilCtr.getCurrentAbilityLevelMax(key)}}</span>
                          <small ng-if=!abilCtr.isCurrentAbilityLevelCap(key)>+{{abilCtr.getCurrentAbilityLevelUpgradeInc(key)}}</small>
                          <span ng-bind=abilCtr.getAbilityLevelMax(key)></span>
                        </td>
                        <td class=text-center>
                          <span ng-if=item.passiveAbility>passive</span>
                          <span ng-if=!item.passiveAbility>
                            <span ng-if=abilCtr.isCurrentAbilityAvailable(key)>{{abilCtr.getCurrentAbilityHeightDC(key) | bignum:0:1}}</span>
                            <small ng-if="!abilCtr.isCurrentAbilityLevelCap(key) && !abilCtr.getCurrentAbilityHeightUpgradeIncDC(key).eq(0)">
                              <br>+{{abilCtr.getCurrentAbilityHeightUpgradeIncDC(key) | bignum:0:1}}</small></span>
                        </td>
                        <td class=text-center>
                          <span ng-if=abilCtr.isCurrentAbilityAvailable(key) ng-bind-html=abilCtr.getCurrentVisualAbilityEffectMultDC(key)></span>
                          <small ng-if=!abilCtr.isCurrentAbilityLevelCap(key)>
                            <br>
                            <span ng-bind-html=abilCtr.getCurrentVisualAbilityEffectMultUpgradeIncDC(key)></span>
                          </small>
                        </td>
                        <td>
                          <button type=button class="btn btn-primary btn-block animate-fade" ng-show=!abilCtr.isCurrentAbilityLevelCap(key) ng-click=abilCtr.upgradeCurrentAbility(key) ng-disabled=!abilCtr.isCurrentAbilityUpgradeable(key)>AP {{abilCtr.getCurrentAbilityUpgradePrice(key)}}</button></td>
                        <td>
                          <button type=button class="btn btn-default btn-block" ng-if=!item.passiveAbility ng-click=abilCtr.addCurrentAbilityToQueue(key) ng-disabled="!abilCtr.isCurrentAbilityAvailable(key) || abilCtr.isCurrentAbilityActive(key)">
                            <span class="glyphicon glyphicon-chevron-right"></span>
                          </button>
                        </td>
                      </tr>
                      <tr ng-if="!abilCtr.isCurrentAbilityCanBeBought(key) && !abilCtr.isCurrentAbilityHidden(key)">
                        <td>
                          <b ng-bind=item.name></b>
                          <a href="index.html#" ng-click=abilCtr.toggleAbilityDescrVisible(key) m-prevent-default>
                            <span class="glyphicon glyphicon-question-sign"></span>
                          </a>
                          <div class=animate-slide ng-show=abilCtr.isAbilityDescrVisible(key)>
                            <small ng-bind-html=abilCtr.getCurrentAbilityDescr(key)></small>
                          </div>
                        </td>
                        <td colspan=6 class=text-center>Tube {{abilCtr.getSelectedTubeId() + 1}}
                          <sup>{{item.imprLvlMin + 1}}</sup>required</td></tr>
                      <tr ng-repeat-end ng-if=abilCtr.isCurrentAbilityHidden(key)>
                        <td>???????</td>
                        <td colspan=6 class=text-center>Tube {{abilCtr.getSelectedTubeId() + 1}}
                          <sup>{{item.imprLvlMin + 1}}</sup>required</td></tr>
                    </table>
                  </div>
                  <div class=col-xs-4>
                    <div class="panel panel-default">
                      <div class="panel-heading text-center">Abilities queue {{abilCtr.getCurrentQueueSize()}} of {{abilCtr.getCurrentQueueSizeMax()}}</div>
                      <div class="panel-body scroll-section-ability-queue">
                        <div ng-repeat="queueAbilityId in abilCtr.getQueue() track by $index" class="list-group list-group-small-gap">
                          <div class=list-group-item ng-class="{'list-group-item-info':abilCtr.isCurrentAbilityActiveByQueueIdx($index)}">
                            <button type=button class="btn btn-default btn-xs" ng-click=abilCtr.removeCurrentAbilityFromQueue($index)>
                              <span class="glyphicon glyphicon-chevron-left"></span>
                            </button>
                            <b ng-bind=abilCtr.getAbilityName(queueAbilityId)></b>
                            <div class=pull-right ng-if="abilCtr.getCurrentQueueSize() > 1">
                              <div class="btn-group btn-group-xs" role=group>
                                <button type=button class="btn btn-default" ng-click="abilCtr.changeCurrentAbilityPosInQueue($index, -1)" ng-disabled="$first || abilCtr.isCurrentAbilityActive(key)">
                                  <span class="glyphicon glyphicon-chevron-up"></span>
                                </button>
                                <button type=button class="btn btn-default" ng-click="abilCtr.changeCurrentAbilityPosInQueue($index, 1)" ng-disabled="$last || abilCtr.isCurrentAbilityActive(key)">
                                  <span class="glyphicon glyphicon-chevron-down"></span>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer modal-condensed">
                <div class=text-center>
                  <button type=button class="btn btn-default" ng-click=abilCtr.hideTubeAbilityDlg()>&nbsp;Close&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-show=isResetSystemDialogVisible()>
          <div class="modal-backdrop in" ng-click=hideResetSystemDialog()></div>
          <div class=modal-dialog ng-if=isResetSystemDialogVisible()>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>Meta-energy activator</h4></div>
              <div class=modal-body>
                <p>Are you sure
                  <u>to sell all you tubes, balls, reset all energy upgrades</u>and activate
                  <span class=num>{{getInactiveMetaEnergy() | bignum:2}}</span>inactive meta-energy?</p></div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-danger" ng-click=processReset()>&nbsp;Yes&nbsp;</button>
                  <button type=button class="btn btn-default" ng-click=hideResetSystemDialog()>&nbsp;Cancel&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-show=isShowFirstImproveDlg()>
          <div class="modal-backdrop in" ng-click=hideFirstImproveDlg()></div>
          <div class=modal-dialog>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>Congratulations!</h4></div>
              <div class=modal-body>
                <p>Now you can buy tube/ball abilities in the
                  <b>Abilities</b>sub-tab of
                  <b>Upgrades</b>tab.</p>
                <p>Also you can change the ball style in the
                  <b>Settings</b>tab.</p>
              </div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-primary" ng-click=hideFirstImproveDlg()>&nbsp;OK&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-show=isShowOfflineStats()>
          <div class="modal-backdrop in" ng-click=hideOfflineStats()></div>
          <div class=modal-dialog>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>Welcome back
                  <span ng-if=!kongregateInfo().isGuest>, {{kongregateInfo().userName}}</span>
                  <span ng-if="isSteamInit() && steamName()">, {{steamName()}}</span>!</h4></div>
              <div class=modal-body>
                <p>You were offline for {{offlineTime()}}.</p>
                <p>You earned
                  <span class="glyphicon glyphicon-flash"></span>
                  <span class=num>{{offlineMoneyEarnedDC() | bignum:2:3}}</span></p>
              </div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-primary" ng-click=hideOfflineStats()>&nbsp;OK&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-show=isShowNewBalanceAbilityDlg()>
          <div class="modal-backdrop in" ng-click=hideNewBalanceAbilityDlg()></div>
          <div class=modal-dialog>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>Changes</h4></div>
              <div class=modal-body>
                <p>We have added special abilities to each tube, available after you improve any tube at least once. Due to abilities we had to modify later-game balance (upgrade costs), but you will only see new balance on each tube after you improve it, or on all tubes after you activate meta-energy (soft reset).</p>
                <p>We give you 1 free inactive meta-energy for you to be able to soft reset to experience new balance and abilities (be sure to improve all tubes to max level before reseting to get ability points!). But this is not required. You can also just continue playing normally and after improving tubes you'll see new balance and abilities as well.</p>
                <p>Feel free to post your thoughts on abilities and new balance in the comments! We sure are interested to hear all players thoughts on the subject. Have fun!</p>
              </div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-default" ng-click=hideNewBalanceAbilityDlg()>&nbsp;Close&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-controller="BoostDailyController as bstDailyCtr" ng-show=bstDailyCtr.isDlgVisible()>
          <div class="modal-backdrop in" ng-click=bstDailyCtr.hideDlg()></div>
          <div class=modal-dialog ng-if=bstDailyCtr.isDlgVisible()>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>You have new daily reward!</h4></div>
              <div class=modal-body>
                <p ng-if="bstDailyCtr.getDaysPlayedInRow() > 1">You have been playing for {{bstDailyCtr.getDaysPlayedInRow()}} days in a row.</p>
                <p ng-if=bstDailyCtr.isGemsReward()>Your reward:
                  <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>{{bstDailyCtr.getGemsValue()}}</p>
                <table class="table table-bordered" ng-if=!bstDailyCtr.isGemsReward()>
                  <tr>
                    <th>Reward type</th>
                    <th class=text-center>Reward value</th>
                    <th class=text-center>Days-in-a-row multiplier</th>
                    <th class=text-center>Total reward value</th>
                    <th class=text-center>Reward duration</th></tr>
                  <tr class=alert-warning>
                    <td ng-bind-html=bstDailyCtr.getBoostType()></td>
                    <td class=text-center>+{{bstDailyCtr.getBoostValue() | number:1}}%</td>
                    <td class=text-center>x{{bstDailyCtr.getBoostDayMult() | number:1}}</td>
                    <td class=text-center>+{{bstDailyCtr.getBoostTotalValue() | number:1}}%</td>
                    <td class=text-center>{{bstDailyCtr.getBoostDuration()}}</td></tr>
                  <tr>
                    <td></td>
                    <td>
                      <button type=button class="btn btn-default btn-block" ng-click=bstDailyCtr.showPremiumConfirmDialog(0)>Re-roll for
                        <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>1</button></td>
                    <td></td>
                    <td></td>
                    <td>
                      <button type=button class="btn btn-default btn-block" ng-click=bstDailyCtr.showPremiumConfirmDialog(1)>Re-roll for
                        <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>1</button></td>
                  </tr>
                  <tr>
                    <td colspan=2>
                      <button type=button class="btn btn-default btn-block" ng-click=bstDailyCtr.showPremiumConfirmDialog(2)>Re-roll for
                        <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>2</button></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td colspan=5>
                      <button type=button class="btn btn-default btn-block" ng-click=bstDailyCtr.showPremiumConfirmDialog(3)>Re-roll for
                        <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>3</button></td>
                  </tr>
                </table>
                <div ng-controller="StatisticsController as statsCtr">
                  <p ng-if="statsCtr.isBoostDailyActive() && !bstDailyCtr.isGemsReward()">
                    <b>Current daily reward</b>: {{statsCtr.getBoostDailyType()}} +{{statsCtr.getBoostDailyTotalValue() | number:1}}% duration {{statsCtr.getBoostDailyDuration()}}</p>
                </div>
              </div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-primary" ng-click=bstDailyCtr.applyAndHideDlg()>&nbsp;{{bstDailyCtr.getRewardButtonText()}}&nbsp;</button>
                  <button type=button class="btn btn-default" ng-click=bstDailyCtr.hideDlg()>&nbsp;Close&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-show=isShowEventWelcomeMsg()>
          <div class="modal-backdrop in" ng-click=hideEventWelcomeMsg()></div>
          <div class=modal-dialog>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>Halloween Event is now LIVE!</h4></div>
              <div class=modal-body>This is time limited event which will run for 21 days only and will not be available after that!
                <br>Click the tab with
                <img ng-src=imgs/{{getThemeImgDir()}}/halloweenicon.gif class=tab-img>to start/switch to the event.
                <br>Complete special achievements in the event (
                <i>Big Jack-o'-Lantern</i>) to earn special items which give you permanent bonuses.
                <br>Gems are shared between your main game and event, but all shop items are not. Everything you buy in the shop in Halloween Event applies to event only! But any gems earned in the event can be used in your main game and vice versa.
                <br>Save game is the same for event and main game. If you save in the event, your main game progress will automatically save as well. If you save in the main game, your event progress will also be saved.
                <br>If you like/dislike something about the event, please leave a comment.
                <br>
                <br>Good luck!</div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-primary" ng-click=hideEventWelcomeMsg()>&nbsp;OK&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-show=isBoostDialogVisible()>
          <div class="modal-backdrop in" ng-click=closeBoostDialog(false)></div>
          <div class=modal-dialog ng-if=isBoostDialogVisible()>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title ng-bind=getBoostDialogHeader()></h4>
              </div>
              <div class=modal-body>
                <p ng-bind-html=getBoostDialogText()></p>
              </div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-primary" ng-click=closeBoostDialog(true)>&nbsp;{{getBoostDialogButtonText()}}&nbsp;</button>
                  <button type=button class="btn btn-default" ng-click=closeBoostDialog(false)>&nbsp;Cancel&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-controller="PremiumController as premCtr" ng-show=premCtr.isPremiumConfirmDialogVisible()>
          <div class="modal-backdrop in" ng-click=premCtr.hidePremiumConfirmDialog()></div>
          <div class=modal-dialog ng-if=premCtr.isPremiumConfirmDialogVisible()>
            <div class=modal-content>
              <div class="modal-body text-center">
                <span ng-if=premCtr.canBuyPremiumSelectedItem()>Are you sure you want to spent
                  <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>{{premCtr.getPremiumSelectedItem().price}} and buy
                  <b>{{premCtr.getPremiumSelectedItem().name}}</b>?</span>
                <span ng-if=!premCtr.canBuyPremiumSelectedItem()>You need additional
                  <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>{{premCtr.premiumMoneyToBuySelectedItem()}} to buy
                  <b>{{premCtr.getPremiumSelectedItem().name}}</b>.
                  <br>Would you like to go to the store?</span></div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-primary" ng-click=premCtr.clickYesPremiumConfirmDialog()>&nbsp;Yes&nbsp;</button>
                  <button type=button class="btn btn-default" ng-click=premCtr.hidePremiumConfirmDialog()>&nbsp;No&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-controller="PremiumController as premCtr" ng-show=premCtr.isPremiumDialogVisible()>
          <div class="modal-backdrop in" ng-click=premCtr.hidePremiumDialog()></div>
          <div class="modal-dialog wide-dialog" ng-if=premCtr.isPremiumDialogVisible()>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class="modal-title text-center">You have
                  <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal>{{premCtr.premiumMoney()}}</h4></div>
              <div class=modal-body>
                <div ng-if="isKongregateAPI() && !isKongregateUserLoggedIn()">
                  <div class=text-center>
                    <p>Only Registered Kongregate users can buy from the shop.</p>
                    <p>Please register below or log into your account.</p>
                    <p>
                      <a href="index.html#" ng-click=kongregateShowRegistrationBox() m-prevent-default>
                        <img src="imgs/register_kongregate.png"></a>
                    </p>
                  </div>
                </div>
                <div ng-if="isKongregateVersion && !isKongregateAPI()">
                  <div class=text-center>
                    <p>Premium Shop is available at Kongregate.com website only.</p>
                    <p>If you already play this game at Kongregate.com website, then it's likely your ad blocker or security preferences prevent the game from connecting to Kongregate servers.</p>
                    <p>Try disabling your ad blocker or adding exceptions for kongregate.com and then refresh game page.</p>
                    <p>
                      <a ng-href={{kongGameURL}} target=_top>
                        <img src="imgs/register_kongregate.png"></a>
                    </p>
                  </div>
                </div>
                <div ng-if="isSteamVersion && !isSteamInit()">
                  <div class=text-center>
                    <p>Please start Steam client to buy from the shop.</p>
                  </div>
                </div>
                <table class="table table-hover table-td-valign" ng-if="isKongregateUserLoggedIn() || isSteamInit()">
                  <tr ng-repeat="(key, item) in premCtr.premiumPackList" ng-if=premCtr.isPremiumPackAvailable(key) ng-class={success:item.title}>
                    <td style=white-space:nowrap>
                      <img ng-src=imgs/{{getThemeImgDir()}}/premium.svg class=premium-crystal-list-item>
                      <span ng-if="item.premiumBonusPercent!=0">
                        <del>{{item.premiumMoneyBase}}</del></span>{{item.premiumMoney}}</td>
                    <td class=text-center>
                      <span ng-bind-html=item.title></span>
                      <span ng-if="item.premiumBonusPercent!=0">+{{item.premiumBonusPercent}}% bonus</span></td>
                    <td style=white-space:nowrap>
                      <span ng-if=item.oldPrice>
                        <span ng-bind-html=moneySignHTML></span>
                        <del>{{convertMoney(item.oldPrice)}}</del>
                        <br></span>
                      <span ng-bind-html=moneySignHTML></span>{{convertMoney(item.price)}}</td>
                    <td>
                      <button type=button class="btn btn-primary btn-sm btn-block" ng-click=premCtr.buyPremiumPack(key)>BUY</button></td>
                  </tr>
                </table>
              </div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-default" ng-click=premCtr.hidePremiumDialog()>&nbsp;Close&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-show=isShowIdleModeHelp()>
          <div class="modal-backdrop in" ng-click=hideIdleModeHelp()></div>
          <div class="modal-dialog wide-dialog">
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>Idle mode</h4></div>
              <div class=modal-body>
                <i>Idle mode</i>will be available when you buy
                <i>Idle bonus multiplier</i>meta-energy upgrade or the same name item in the Shop.
                <br>To activate
                <i>Idle mode</i>you must not do the following actions during 2 minutes:
                <br>
                <ul>
                  <li>click in the tubes, balls or bubbles</li>
                  <li>upgrade anything</li>
                  <li>activate meta-energy</li></ul>1 minute before
                <i>Idle mode</i>activation you'll see
                <span class="glyphicon glyphicon-hourglass"></span>under the energy bar with time countdown.
                <br>After
                <i>Idle mode</i>is activated you'll see
                <span class="glyphicon glyphicon-time"></span>with
                <i>Idle mode</i>timer and information about your idle bonus:
                <br>
                <p class=text-center>Idle
                  <span class="glyphicon glyphicon-flash"></span>
                  <b>10</b>(
                  <span class="glyphicon glyphicon-flash"></span>100 &times; 0.10)</p>where
                <span class="glyphicon glyphicon-flash"></span>
                <b>10</b>- you current idle bonus,
                <span class="glyphicon glyphicon-flash"></span>100 - idle energy gathered after
                <i>Idle mode</i>activation, x0.10 - you current idle energy multiplier.
                <br>When you do any activity listed above except
                <i>Activate meta-energy</i>idle bonus will be transferred to the main energy storage in 5 seconds. If you use
                <i>Activate meta-energy</i>then idle bonus will be added to the main storage immediately before meta-energy activation.
                <br>There are 2 idle mode parameters:
                <i>Idle bonus multiplier</i>and
                <i>Idle multiplier growth time</i>.
                <br>
                <i>Idle bonus multiplier</i>increases every hour until idle time reaches
                <i>Idle multiplier growth time</i>and then it stops growing.
                <br>For example: you have
                <i>Idle bonus multiplier</i>0.5 and
                <i>Idle multiplier growth time</i>3 hours.
                <br>After 1 hour your
                <i>Idle bonus multiplier</i>will be 0.5, i.e. +50% to idle energy, 2 hours - add another 50% to previous 50% => 1.5 * 1.5 - 1 = 1.25 (+125%), 3 hours - add 50% again => 1.5 * 1.5 * 1.5 - 1 = 2.375 (+237.5%). After 3 hours
                <i>Idle bonus multiplier</i>will remain constant at 2.375 (+237.5%).
                <br>If you have gathered 100 idle energy and exit
                <i>Idle mode</i>(by doing any listed action), then you'll receive 100 * 2.375 = 237.5 bonus energy.</div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-default" ng-click=hideIdleModeHelp()>&nbsp;Close&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-controller="CloudController as cloudCtr" ng-show=cloudCtr.isCloudDialogVisible()>
          <div class="modal-backdrop in" ng-click=cloudCtr.hideCloudDialog()></div>
          <div class=modal-dialog ng-if=cloudCtr.isCloudDialogVisible()>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>Cloud save/load</h4></div>
              <div class=modal-body>
                <div ng-if=isKongregateAPI()>
                  <div ng-if=isKongregateUserLoggedIn()>
                    <div class="progress animate-fade" ng-show=cloudCtr.isLoadFromCloudStarted()>
                      <div class="progress-bar progress-bar-info progress-bar-striped active" style=width:100%></div>
                      <div class=progress-text>Connecting to the cloud...</div></div>
                    <div class="progress animate-fade" ng-show=cloudCtr.isSaveToCloudStarted()>
                      <div class="progress-bar progress-bar-danger progress-bar-striped active" style=width:100%></div>
                      <div class=progress-text>Saving to the cloud...</div></div>
                    <div ng-if=cloudCtr.isLoadFromCloudSuccess()>
                      <table class="table table-bordered">
                        <tr>
                          <td></td>
                          <th>Local</th>
                          <th>Cloud</th></tr>
                        <tr>
                          <th>Save time</th>
                          <td>Now</td>
                          <td ng-bind=cloudCtr.getCloudDataTime()></td>
                        </tr>
                        <tr>
                          <th>Energy</th>
                          <td>
                            <span class="glyphicon glyphicon-flash"></span>{{energyDC() | bignum:2}}</td>
                          <td>
                            <span class="glyphicon glyphicon-flash"></span>{{cloudCtr.getCloudDataEnergyDC() | bignum:2}}</td>
                        </tr>
                      </table>
                    </div>
                    <div ng-if=cloudCtr.isLoadFromCloudEmpty()>
                      <p class="text-info text-center">No cloud data found.</p></div>
                    <div ng-if=cloudCtr.isLoadFromCloudError()>
                      <p class="text-danger text-center">ERROR: Can't load data from the cloud.</p></div>
                    <div ng-if=cloudCtr.isSaveToCloudSuccess()>
                      <p class="text-success text-center">Data saved to the cloud successfully.</p></div>
                    <div ng-if=cloudCtr.isSaveToCloudError()>
                      <p class="text-danger text-center">ERROR: Can't save data to the cloud.</p></div>
                  </div>
                  <div class=text-center ng-if=!isKongregateUserLoggedIn()>
                    <p>Only Registered Kongregate users can save to or load from the cloud.</p>
                    <p>Please register below or log into your account.</p>
                    <p>
                      <a href="index.html#" ng-click=cloudCtr.hideCloudDialog();kongregateShowRegistrationBox(); m-prevent-default>
                        <img src="imgs/register_kongregate.png"></a>
                    </p>
                  </div>
                </div>
                <div class=text-center ng-if=!isKongregateAPI()>
                  <p>Cloud save/load is available at Kongregate.com website only.</p>
                  <p>If you already play this game at Kongregate.com website, then it's likely your ad blocker or security preferences prevent the game from connecting to Kongregate servers.</p>
                  <p>Try disabling your ad blocker or adding exceptions for kongregate.com and then refresh game page.</p>
                  <p>
                    <a ng-href={{kongGameURL}} target=_top>
                      <img src="imgs/register_kongregate.png"></a>
                  </p>
                </div>
              </div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-default btn-danger" ng-if=cloudCtr.isCloudOperationsAllowed() ng-disabled=!cloudCtr.isCloudSaveAllowed() ng-click=cloudCtr.saveToCloud() ng-bind-html=cloudCtr.getSaveButtonText()></button>
                  <button type=button class="btn btn-default btn-info" ng-if=cloudCtr.isCloudOperationsAllowed() ng-disabled=!cloudCtr.isLoadFromCloudSuccess() ng-click=cloudCtr.loadGameFromCloudData()>&nbsp;Load&nbsp;</button>
                  <button type=button class="btn btn-default" ng-click=cloudCtr.hideCloudDialog()>&nbsp;Close&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal animate-fade" tabindex=-1 role=dialog style=display:block ng-show=isShowChangeLog()>
          <div class="modal-backdrop in" ng-click=hideChangeLog()></div>
          <div class=modal-dialog>
            <div class=modal-content>
              <div class=modal-header>
                <h4 class=modal-title>Change Log</h4></div>
              <div class=modal-body>
                <b>
                  <u>Version 1.1.0</u>
                </b>
                <br>
                <ul>
                  <li>added tube's energy proportion value</li>
                  <li>added option to enable/disable energy text on every bounce</li>
                  <li>added different figures for each tube improve</li></ul>
              </div>
              <div class=modal-footer>
                <div class=text-center>
                  <button type=button class="btn btn-default" ng-click=hideChangeLog()>&nbsp;Close&nbsp;</button></div>
              </div>
            </div>
          </div>
        </div>
        <div class="waiting-shadow animate-fade" ng-show=isWaitingMsgVisible()>
          <div class=waiting-text>
            <div class=progress>
              <div class="progress-bar progress-bar-info progress-bar-striped active" style=width:100%></div>
              <div class=progress-text ng-bind-html=getWaitingMsgText()></div>
            </div>
            <div class="panel panel-info animate-slide" ng-show=getWaitingMsgInfo()>
              <div class=panel-body>
                <div ng-bind-html=getWaitingMsgInfo()></div>
                <br>
                <div class=text-center>
                  <button type=button class="btn btn-default" ng-click=hideWaitingMsg()>Continue {{getWaitingMsgTimeRemain()}}</button></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--[if lt IE 9]>
      <p class=ontop>You are using an
        <strong>outdated</strong>browser. Please
        <a href=http://browsehappy.com/ target=_blank>upgrade your browser</a>to improve your experience.</p>
    <![endif]-->
    <noscript>
      <p class=ontop>JavaScript must be enabled to run this game.</p></noscript>
  </body>

</html>